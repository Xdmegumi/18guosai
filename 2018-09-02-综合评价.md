## 综合评价

> 随着所需考虑的因素越来越多，规模越来越大，对评价工作本身的要求也越来越高，要求它克服**主观性和片面性**。体现出**科学性和规范性**。而且，当前的评价工作不但要考虑结构化、定量化的因素，而且要考虑大量的非结构化、半结构化、**模糊性、灰色性**的因素

> 综合评价模型：所谓多指标综合评价，就是指通过一定的数学模型将多个评价指标值“**合成**”为一个整体性的综合评价值。可用于“合成”的数学方法较多。问题在于我们
> 如何根据**评价目的及被评价对象的特点**来选择较为合适的合成方法

> 综合评价结果只具有**相对**意义，即只能用于**性质相同**的对象之间的比较和排序



### 指标建立原则

1. 指标宜少不宜多，宜简不宜繁

   > 关注综合性指标

2. 指标应具有独立性

   > 相关性强的时候才考虑**因子分析**

3. 指标应具有代表性，能很好地反映研究对象某方面的特性

4. 指标应可行，符合客观实际水平，有**稳定的数据来源**

对于定量指标，其性质和量纲也有不同，造成了各指标间的**不可共度性**。为了尽可能地反映实际情况，排除由于各项指标的单位不同以及其数值数量级间的悬殊差别所带来的影响，避免不合理现象的发生，需要对评价指标作**无量纲化处理**。



#### 指标剔除

##### 最小标准差法

将最小标准差为0的指标**删除**



##### 一致化（指标正向化）

1. 倒数法

   ![这里写图片描述](http://img.blog.csdn.net/20161123191635650)

   适合**大于零**的极小型指标

2. 最小阈值法

   ![这里写图片描述](http://img.blog.csdn.net/20161124181903990)

   适合**数据均大于零**的极小型指标

3. 最大阈值法

   ![这里写图片描述](http://img.blog.csdn.net/20161124182008040)

   适合数据均大于零的。。。

4. 绝对值倒数法

   ![这里写图片描述](http://img.blog.csdn.net/20161123191455493)

   $x_0$为标准差，偏差越小越好，从而倒数越大越好。适合**区间型指标**

5. 距离倒数法

   ![这里写图片描述](http://img.blog.csdn.net/20161123191219756)

   与绝对值类似



##### 无量刚化

> 指标的无量纲化可以消除指标间量级不同的影响，可以使各个指标转化成可以直接**加减的**数值

1. 中心化也称均值化

   ![这里写图片描述](http://img.blog.csdn.net/20161104165255837)

   此处的$E$可以是算术平均值，也可以是中位数、总数，根据实际需求来定

2. **规格化**

   ![这里写图片描述](http://img.blog.csdn.net/20161104171608680)

   无量纲化之后，数据范围$0-1$之间，表明了数据在**全局**中的**相对位置**

3. **标准化** 

   ![这里写图片描述](http://img.blog.csdn.net/20161104172814071)

   该方法适用于数据量较大的情况，样本数要在30以上，评价值在-1至1之间

   >  SPSS默认方法

4. **比重法**

   ![这里写图片描述](http://img.blog.csdn.net/20161104174532400)

   可以应用于含负值的情况

   ​

## 指标权重的确定

指标间的权重差异主要是以下三方面的原因造成的：

* 评价者对各指标的重视程度不同，反映评价者的**主观**差异
* 各指标在评价中所起的作用不同，反映各指标间的**客观**差异
* 各指标的**可靠程度**不同，反映了各指标所提供的信息的可靠性不同

> 因此常采用先**假设**数据均可靠的前提下使用**主客观相结合**的方法



虽然主观赋权法带有一定的主观色彩，但“**主观”与“随意**”是两个不同的概念，人们对指标重要程度的估计主要来源于客观实际，主观看法的形成往往与评价者所处的客观环境有着直接的联系



* 专家评价方法，如专家打分综合法。
* **运筹学**与其他数学方法，如**层次分析法、数据包络分析法、模糊综合评判法**。
* 新型评价方法，如**人工神经网络评价法、灰色综合评价法**。
* 混合方法，这是几种方法**混合使用**的情况。如AHP ＋ 模糊综合评判、模糊神经网络评价法。

到目前为止，虽然出现了多种综合评价方法，但还有不少的问题。比如，针对同一问
题**，不同的方法会得到不同的结果，如何解释**？ 如何辨别不同方法的优劣？ 如何衡量评价
结果的客观准确性？ 这些问题还需要我们进一步探索和研究，使综合评价方法和理论不
断得以丰富和完善。





## 层次分析法

这一方法的特点，是在对复杂决策问题的本质、影响因素以及内在关系等进行深入分析之后，构建一个**层次结构**模型，然后利用较少的定量信息，把决策的思维过程数学化，从而为求解多目标、多准则或无结构特性的复杂决策问题，提供一种简便的决策方法。尤其**适合于人的定性判断起重要作用的、对决策结果难于直接准确计量**的场合



> 应用层次分析法分析问题时，首先要把问题层次化。根据问题的性质和要达到的总
> 目标，将问题分解为不同组成因素，并按照因素间的**相互关联影响以及隶属关系**将因素按不同层次聚集组合，形成一个多层次的分析结构模型。并最终把系统分析归结为最底层（供决策的方案、措施等） ，相对于最高层（总目标）的相对重要性权值的确定或相对优劣次序的排序问题。在排序计算中，每一层次的因素相对上一层次某一因素的单排序问题又可简化为以系列成对因素的判断比较。为了将比较判断定量化，层次分析法引入了１ — ９标度法，并写成判断矩阵形式。形成判断矩阵后，即可通过计算判断矩阵的最大特征根及其对应的特征向量，计算出**某一层对于上一层次某一个元素的相对重要性权值**。在计算出某一层次相对于上一层次各个因素的单排序权值后，用上一层次因素本身的权值加权综合，即可计算出某层因素相对于上一层次的相对重要性权值，即层次总排序权值。这样，依次**由上而下**即可计算出最低层因素相对于最高层的相对重要性权值或相对优劣次序的排序值。



### 模型和步骤

* 构造层次分析结构

  > 与因子分析不同的是，准则层的构建得主观先给出，并且每一个准则可以不和每一个方案层有关

  建立问题的层次结构模型是**AHP** 法中最重要的一步，把复杂的问题分解成称之为元素的各个组成部分，并按元素的相互关系及其隶属关系形成不同的层次，同一层次的元素作为准则对下一层次的元素起**支配作用**，同时它又受上一层次元素的支配

  > 层次结构建立在决策者（或分析者）对问题全面深入认识的基础之上。如果在层的划分和确定层次的支配关系上**举棋不定**，最好的办法是重新分析问题

* 构造判断矩阵

  > 假定上一层次的元素$B_k $作为准则，对下一层元素$C１ ，C２ ，⋯ ，Cn $有支配关系，我们的目的是要在准则$B_k$ 下按它们的相对重要性赋予$C１ ，C２ ，⋯ ，Cn $相应的权重。在这一步中要回答下面的问题：针对准则$B-k$ ，两个元素$C_i ，C_j $哪个更重要，重要性的大小。需要对“重要性”赋予一定的数值。赋值的根据或来源，可以是由决策者直接提供，或是通过决策者与分析者对话来确定，或是由分析者通过某种技术咨询而获得，或是通过其他合适的途径来酌定。一般地，判断矩阵应由熟悉问题的**专家独立**地给出。

  判断矩阵的性质：

  * $C_{ij}>0$

  * $C_{ij}=\frac{1}{C_{ji}}$

  * $C_{ii}=1$

    若有$C_{ij}C_{jk}=C_{ik}$，则称为一致矩阵

  > 值得注意的是，在实际问题求解时，构造的判断矩阵并不一定具有一致性，常常需要进行**一致性检验**

  ![层次分析法](C:\Users\16053\Desktop\美赛\层次分析法.bmp)

  从而可以得到目标层与准则层的判断矩阵$A​$,以及一级指标与二级指标之间的判断矩阵$B_1,B_2,\cdots,B_m​$

* 判断矩阵的一致性检验
  $$
  CI=\frac{\lambda_{max}-n}{n-1}
  $$
  $CI=0$则完全一致（判断矩阵满秩），当阶数大于２ 时，判断矩阵的一致性指标$CI $与同阶平均随机一致性指标$R I $之比称为随机一致性比率，记为$CR$ 。当$CR=\frac{CI}{RI} <0.10$时，即认为判断矩阵具有满意的一致性，否则就需要调整判断矩阵，使之具有满意的一致性。$RI如表2-2$![RI](C:\Users\16053\Desktop\美赛\RI.bmp)

* 层次单排序

  由最大值的特征向量排序

* 层次总排序

  > 层次总排序要进行一致性检验，检验是从高层到低层进行的。但也有最新的研究指
  > 出，在AHP 法中不必检验层次总排序的一致性。也就是说，在实际操作中，总排序一致性检验**常常**可以省略。

* ![层次分析法结果](C:\Users\16053\Desktop\美赛\层次分析法结果.bmp)




### 决策



## 模糊综合评价

> 模糊综合评价是借助模糊数学的一些概念，对实际的综合评价问题提供一些评价的
> 方法。具体地说，模糊综合评价就是以模糊数学为基础，应用模糊关系合成的原理，将一些边界不清、不易定量的因素定量化，从多个因素对被评价事物隶属等级状况进行综合性评价的一种方法。综合评判对评判对象的全体，根据所给的条件，给每个对象赋予一个非负实数——— **评判指标**，再据此排序择优。

### 模型和步骤

* 确定评价因素、评价等级

* 构造**评判矩阵**和确定权重

  首先对着眼因素集中的单因素$u_i （i＝ １ ，２ ，⋯ ，m）$ 作单因素评判，从因素$u_i $着眼该事物对抉择等级$v_j （j ＝ １ ，２ ，⋯ ，n）$的隶属度为$r_{ij}$ ，这样就得出第$i $个因素$u_i$ 的单因素评判集：$r_i=(r_{i1},r_{i2},\cdots r_{in})$

  即每一个被评价对象确定了从$U$到$V $的模糊关系$R_{m,n}$ ，它是一个矩阵：

  具体地说，$r_{ij }$表示第$i$ 个因素$u_i$ 在第$j $个评语$v _j $上的频率分布，一般将其归一化使之满足$Σ r_{ij }＝ １$

* 建立评判模型，进行综合评判

  确定几个方面的权数，并利用模糊合成计算：

  $B=A*R$，其中*为**模糊算子，选取很重要**，再对$B$进行归一化

  > 权数的确定反映了不同特征的决策者，算自选取：
  >
  > * 加权平均型：因素集很多的情形
  > * 主因素突出型；所统计的模糊矩阵中的数据相差很远的情
  >   形，是**现实问题的性质决定算子的选择**，而不是算子决定现实问
  >   题的性质。

  ​

  ​

## 数据包络分析(EDA)

> 一个经济系统或一个生产过程可以看成一个单元在一定可能范围内，通过投入一定
> 数量的生产要素并产出一定数量的“产品”的活动。虽然这些活动的具体内容各不相同，
> 但其目的都是尽可能地使这一活动取得最大的“**效益**” 。由于从“投入”到“产出”需要经过
> 一系列决策才能实现，或者说，由于“**产出**”是决策的结果，所以这样的单元被称为决策单元（**Decision Making Units ，DMU**） 。可以认为每个**DMU** 都代表一定的经济意义，它的基本特点是具有一定的输入和输出，并且在将输入转换成为输出的过程中，努力实现自身的决策目标

评价的依据是决策单元的“输入”数据和“输出”数据。每个决策单元的有效性将涉及两个方面

1. 建立在相互比较的基础上，因此是相对有效性
2. 每个决策单元的有效性紧密依赖于**输入综合与输出综合的比**（或理解为多输入— 多输出时的投入— 产出比）

决策单元的**相对有效性**（即决策单元的优劣）被称为**DEA** 有效

> 通过输入和输出数据的综合分析**，DEA** 可以得出每个**DMU** 综合**效率**的数量指标。据此将各决策单元定级排队，确定有效的决策单元，并可给出其他决策单元**非有效的原因和程度**。它不仅可对同一类型各决策单元的相对有效性做出评价与排序，而且还可以进一步分析各决策单元**非DEA 有效的原因及其改进方向**，从而为决策者提供重要的管理决策信息

可以说，在处理**多输入— 多输出的**有效性评价方面，**DEA**具有绝对优势。

DEA 特别适用于具有多输入多输出的复杂系统，这主要体现在以下几点：

* DEA 以决策单元各**输入输出的权重**为变量，从最有利于决策单元的角度进行评价，从而避免了确定各指标在**优先**意义下的权重。
* 假定每个输入都关联到一个或者多个输出，而且输出输入之间确实存在某种关系，使用DEA 方法则不必确定这种**关系的显示表达式**
* 假定每个输入都关联到一个或者多个输出，而且输出输入之间确实存在某种关系，使用DEA 方法则不必确定这种关系的显示表达式
* DEA 最突出的优点是**无须任何权重假设**，每一输入输出的权重不是根据评价者的主观认定，而是由决策单元的实际数据求得的最优权重。因此，DEA 方法排除了很多主观因素，**具有很强的客观性**。



### 模型和步骤

$C^2R$模型是**DEA** 的第一个模型，我们主要来介绍它









## 人工神经网络

>  由于数学模型有较强的条件限制，导致得出的最佳方案与现实有较大误差。后来，人们分析到有的影响投资方案的因素无法用定量的数据来表示，也就无法通过线性或数学模型来求最佳解。于是人们通过层次分析法和模糊理论的方法建立非线性模型来求最佳解。但是，如果**影响投资中有些因素有变化**时，利用层次分析法或模糊理论方法求得的最佳解也会产生较大的误差，只有重新对各种因素进行分析，**重新建立非线性模型**，这样存在许多重复的工作，而且以前的一些经验性的知识不能得到充分利用

人工神经网络为处理这类**非线性问题**提供了强有力的工具。它是一种智能化的数
据处理方法，其处理具有非线性关系数据的能力，是目前其他方法所无法比拟的。与其他
综合评价方法相比，基于人工神经网络的综![img](file:///C:/Users/16053/Desktop/%E7%BE%8E%E8%B5%9B/%E5%B1%82%E6%AC%A1%E5%88%86%E6%9E%90%E6%B3%95%E7%BB%93%E6%9E%9C.bmp?lastModify=1518444705)合评价方法已越来越显示出它的优越性。



**基于BP 人工神经网络的综合评价方法**具有运算速度快、问题求解效率高、自学习能力强、
适应面宽等优点，较好地模拟了评价专家进行综合评价的过程，因而具有广阔的应用前景。

$１９８９ $年$Robert Hecht$唱$Nielson $证明了一个三层的$BP$ 网可以完成任意的4n$ 维到$m $维
的映照。这实际上已经给了一个基本的设计$BP$ 网络的原则



基于$BP $网络的多指标综合评价神经网络模型的设计如下：

其中输入层节点数$m$ ，即评价指标的个数；输出层节点数$n $为１ ，即评价结果；隐含层节点数$(m*n)/2$

隐节点数没有统一的规则，根据具体对象而定。隐含层的输出函数为$Sigmoid$ 变换
函数，输入和输出层函数为线性函数。

> 足够多的样本训练这个网络



## 灰色综合评价

> 灰色系统是按颜色来命名的。因为，在控制论中，人们常用颜色的深浅来形容信息的
> 明确程度。社会、经济等系统具有明显的层次复杂性，结构关系的模糊性，动态变化的随机性，指标数据的不完全性和不确定性。比如，由于技术方法、人为因素等，造成各种数据误差、短缺甚至**虚假现象即灰色性**。由于贫信息不确定性系统的普遍存在，决定了这一理论具有十分广阔的发展前景。随着灰色系统理论研究的不断深入和发展，已经在许多领域取得不少应用成果。

**灰色系统理论**主要研究下列几个方面：

* 灰色因素的关联分析

* 灰色建模

* 灰色预测

* 灰色决策

* 灰色系统分析

* 灰色系统控制

* 灰色系统优化

  考虑到我们要讨论的灰色综合评价问题，所以将主要讨论灰色关联度分析，也就是探讨基于灰色关联度分析的综合评价方法

回归分析虽然是一种较通用的方法，但大都只用于**少因素的、线性的**。对于多因素
的、**非线性**的则难以处理。灰色系统理论提出了一种新的分析方法，即系统的**关联度分析**
方法。这是根据因素之间**发展态势的相似**或**相异程度**来衡量因素间关联程度的方法。
由于关联度分析方法是按发展趋势作分析，因此对样本量的多少没有要求，也不需要有典型的分布规律。

### 模型与步骤

* 灰色关联度分析

  > 关联分析是灰色系统分析、评价和决策的基础。从思路上看，关联分析是属于**几何处理**范畴的。它是一种**相对性的排序分析**，基本思想是根据**序列曲线几何形状的相似程度**来判断其联系是否紧密，曲线越接近，相应序列之间的关联度就越大，反之就越小

  量化方法：

  1. 绝对关联度
  2. 速率关联度

**评价法**：$R=E \times W$

$R$为评价结果向量，$W$为权重分配向量

$E=\eta_i(k)$为评判矩阵($n\times n$),$\eta_i(k)$为第k个指标与第k个最优指标的关联系数

1. 确定最优指标集

   >  不过在定最优值时，既要考虑到**先进性**，又要考虑到**可行性**。若最优指标选的过高，则不现实，不能实现，评价的结果也就不可能正确

   D

2. 指标值的规范化处理

   C

3. 计算综合评判结果
   $$
   \eta_i(k)=\frac{ \min_i \min_k |C_k^*-C_k^i|+\rho \max_i\max_k|C_k^*-C_k^i|}{|C_k^*-C_k^i+\rho \max_i\max_k|C_k^*-C_k^i|} 
   $$
   $\rho$一般取0.5


$$
r_i=\sum_{k=1}^nW(k) \times \eta_i(k)
$$

关联度越大越优







