## 微分方程与差分方程

### 原理部分——建模

当我们需要对象的某些特性**随时间演变的过程**，分析其本质规律并**预测**他的未来性态、研究他的**控制手段**时，通常要建立对象的动态模型。

> 所以需要预测并控制的模型基本得用微分方程建模，其中又以传染病模型应用最广
>
> 另外可尝试**系统动力学**建模，还有网上看到的自动驾驶预测控制 [文章](https://blog.csdn.net/p23onzq/article/details/78740560)

将微分方程离散化便得到差分方程，但也有一些实际问题直接用差分方程的模型更为方便

与常微分方程课程中的动态模型不同的是数模中的系统假设事先是未知的，不同的假设给出不同的模型，事先没有答案，需要寻求最好的。

#### 传染病模型

##### SI 模型

**假设条件**

1. 考察地区内总人数 $N$ 不变，既不考虑生死也不考虑迁移。人群分为**易感染者（S**usceptible）和**已感染者（I**nfective），此两类人所占的比例分别记为 $s(t),i(t)$ 。

2. 每个人每天有效接触的平均人数为 $\lambda$ ，称为**日接触率**

   > 从时间 $\Delta t$ 内接触率为 $\lambda \Delta t$ 

可得模型
$$
\frac{ \mathrm{d}i}{\mathrm{d}t}=\lambda i(1-i),i(0)=i_0
$$
此即 logistic 模型。当 $i$=0.5 时，增长速度最快（**S型增长**）。增长最快的时间
$$
t_m=\lambda^{-1}\ln(\frac{1}{i_0}-1)
$$
此模型中所有人必将感染，因为没有考虑治愈。这同样有重大用途，适用于哪些势不可挡的趋势演变，比如新能源取代旧燃油车的过程

> 新能源汽车的比列即 $i(t)$ ，车主的相互交流与宣传表征了传染的过程，最终新能源汽车将完全替代燃油车

##### SIS 模型

**新增假设：**

* 每天被治愈的病人数占与病人总数的比列为 $\mu$ ，定义 $\sigma=\frac{\lambda}{\mu}$ 表示整个传染过程中每个病人有效接触的平均人数。

$$
\frac{ \mathrm{d}i}{\mathrm{d}t}=\lambda i(1-i)-\mu i= ,i_0=i(0)
$$

具体参数分析略，但是有一个注意点：

> 仅仅从导函数并不能完全刻画原函数的增减信息，很有可能有极限点的存在而导致**分支**

**SIR 模型**

大多数传染病如天花、流感等治愈后既非健康者也非传染者，而以退出传染系统

> 可用于刻画存在第三方干扰的二元竞争

**模型假设：** 

1. 总人数 $N$ 不变。人群分为健康者、病人和病愈免疫的移出者（Removed）三类。其所占比咧分别记为 $s(t),i(t),r(t)$ 
2. 病人的日接触率为 $\lambda$ ,日治愈率为 $\mu$ ,传染期接触数 $\sigma=\frac{\lambda}{\mu}$

有  $s(t)+i(t)+r(t)=1$ ，但是健康者的比例是持续下降的
$$
\left\{ \begin{array}{l}
\frac{{di}}{{dt}} = \lambda si - \mu i,\;i(0) = {i_0}\\
\frac{{ds}}{{dt}} =  - \lambda si,\;s(0) = {s_0}
\end{array} \right.
$$
取定固定参数便可以绘制出两个比例的数值解

![](https://i.loli.net/2018/08/05/5b66d7dbb823f.png)

但是仅仅了解此还不能分析出一般的规律，需要进行**相轨线分析** 

> 相轨线的定义域只有像平面的**左下半边: $s\ge0,t\ge0,s+t \le 1$**

###### 相轨线分析

由微分方程组还可以得出 $i,s$ 之间关系，从而
$$
i=(i_0+s_0)-s+\frac{1}{\sigma}\ln \frac{s}{s_0}
$$
进而可以进行相关的分析。令 $i=0$ 可以得出最后还剩的健康者比例
$$
s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln \frac{s_{\infty}}{s_0}=0
$$
这个式子的意义还在与估计 $\sigma$ ，事实上其他两个参数并不好估计，而计算接触数只需传染的**起点和终点数据**

具体详尽分析略，重点在于绘制出**美观的相轨线分析图**



##### SIB 模型（自建）

部分生活中的模型在健康与感染中其实存在这一个过渡状态或者混合状态，故而修正为以下模型：

![](https://i.loli.net/2018/08/05/5b670aabed51d.jpg)

> 此图用latex绘制，**过键改为过渡**

**模型假设：**

1. 系统总人数 $N$ 保持不变，并存在三种状态且 $s(t)+i(t)+b(t)=1$ 。其中过渡者没有感染他人的能力，有可能继续被感染为传染者，也有可能被治愈好返回健康者阵营
2. 健康者在收到感染时以概率 $p$ 转移为过渡者，概率 $1-p$ 转移为传染者

> 事实上若要考虑死亡只需要切断转移回健康者的两种途径

$$
\left\{ \begin{array}{l}
\frac{{di}}{{dt}} = \lambda si(1 - p) + \lambda sb - \mu i,\;i(0) = {i_0}\\
\frac{{ds}}{{dt}} = \mu (i + b) - \lambda si,\;s(0) = {s_0}\\
\frac{{db}}{{dt}} = \lambda sip - \lambda ib - \mu b,\;b(0) = {b_0}
\end{array} \right.
$$

> 事实上可能过渡者的加入对模型影响并不大，但是针对实际情况可能有考虑的必要，你们帮忙检查下有没有问题



#### 人口阻滞增长模型 Logistic

以美国人口的预测模型为例，小黄书112页
$$
\left\{ \begin{array}{l}
\frac{{dx}}{{dt}} = r(1 - \frac{x}{{{x_m}}})x\\
x({t_0}) = {x_0}
\end{array} \right.
$$
从而
$$
x(t)=\frac{x_m}{1+(\frac{x_m}{x_0}-1)e^{-r(t-t_0)}}
$$
估计参数 $r,x_m$

我修改了之前估计常微分方程组的代码（应该是非线性最小二乘），结果如下

![](https://i.loli.net/2018/08/05/5b671c3568bbf.png)

但却是不同的方法估计的参数会有些许不同，$r=beta(1),x_m=beta(2)$

> beta =
>     0.0274  342.4351
>
>  Estimated Parameters by Lsqnonlin():
> 	 beta 1 = 0.0274 ± 0.0009
> 	 beta 2 = 342.4351 ± 31.3952
>   The sum of the residual squares is: 1.2e+03

我把代码放在开源项目下，到时编程的**比较**一下小黄书的和我之前照的代码

下面对比以下用**时间序列**处理会得到什么结果

![](https://i.loli.net/2018/08/06/5b67205eec320.png)

> 可见时间序列并不会反映出模型系统机理，仅仅是从数据出发并且预测的越远误差越大，除非数据本身规律性很强（周期性等），此处的ARIMA自动预测采取了二阶差分，因为一般时间序列无法解释指数型模型

