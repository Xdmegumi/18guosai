---
layout:     post
title:      "（十六）神经网络模型"
subtitle:   "Neural Networks"
date:       "2017-08-19  12:00:00"
author:     "equation"
header-img: "img/post-bg-nextgen-web-pwa.jpg"
header-mask: 0.3
catalog:    true
tags:
              - 数学建模
---

## 神经网络

***

#### 神经网络简介

人工神经网络是在现代神经科学的基础上提出和发展起来的，旨在反映人脑结构及功能的一种抽象数学模型。自1943 年美国心理学家W. McCulloch 和数学家W. Pitts 提出形式神经元的抽象数学模型—MP 模型以来，人工神经网络理论技术经过了50 多年曲折的发展。特别是20 世纪80 年代，人工神经网络的研究取得了重大进展，有关的理论和方法已经发展成一门界于物理学、数学、计算机科学和神经生物学之间的**交叉学科**。它在模式识别，图像处理，智能控制，组合优化，金融预测与管理，通信，机器人以及专家系统等领域得到广泛的应用，提出了40 多种神经网络模型，其中比较著名的有感知机，Hopfield 网络，Boltzman 机，自适应共振理论及反向传播网络（BP）等。在这里我们仅讨论最基本的网络模型及其学习算法

1. 人工神经元模型

   下图表示出了作为人工神经网络（artificial neural network，以下简称NN）的基本单元的神经元模型，它有三个基本要素：

   ![shenjing](/img/shenjing.jpg)

   * 一组连接（对应于生物神经元的突触），连接强度由各连接上的权值表示，权值为正表示激活，为负表示抑制
   * 一个求和单元，用于求取各输入信号的加权和（线性组合）
   * 一个非线性激活函数，起非线性映射作用并将神经元输出幅度限制在一定范围内（一般限制在 (0,1) 或 (−1,1) 之间）。此外还有一个阈值 $\theta_k$

   以上作用可以用数学表达式表示出来：

$$
u_k=\sum_{j=1}^pw_{kj}x_j,\quad v_k=u_k-\theta_k,\quad y_k=\varphi(v_k)
$$

   激活函数 $\varphi (\cdot)$ 可以有以下几种:

   * 阈值函数即阶梯函数

   * 分段线性函数

     > 它类似于一个放大系数为 1 的**非线性放大器**，当工作于线性区时它是一个线性组合器，放大系数趋于无穷大时变成一个阈值单元

   * sigmoid 函数

   MATLAB工具箱中的激活函数

|    函数名     |    功 能     |
| :--------: | :--------: |
| `purelin`  |   线性传递函数   |
| `hardlim`  |  硬限幅传递函数   |
| `hardlims` | 对称硬限幅传递函数  |
|  `satlin`  |  饱和线性传递函数  |
| `satlins`  | 对称饱和线性传递函数 |
|  `logsig`  | 对数S 形传递函数  |
|  `tansig`  | 正切S 形传递函数  |
|  `radbas`  |  径向基传递函数   |
|  `compet`  |  竞争层传递函数   |

2. 网络结构及工作方式

   除单元特性外，网络的拓扑结构也是NN 的一个重要特性。从连接方式看NN 主要有两种

   * 前馈型网络

     各神经元接受前一层的输入，并输出给下一层，没有反馈。结点分为两类，即输入单元和计算单元，每一计算单元可有任意个输入，但只有一个输出（它可耦合到任意多
     个其它结点作为其输入）。通常前馈网络可分为不同的层，第$i$层的输入只与第$i −1$层输出相连，输入和输出结点与外界相连，而其它中间层则称为隐层。

   * 反馈型网络

     所有结点都是计算单元，同时也可接受输入，并向外界输出。$NN$ 的工作过程主要分为两个阶段：

   第一个阶段是学习期，此时各计算单元状态不变，各连线上的权值可通过学习来修改；

   第二阶段是工作期，此时各连接权固定，计算单元状态变化，以达到某种稳定状态。

   从作用效果看，前馈网络主要是函数映射，可用于**模式识别**和**函数逼近**。反馈网络按对能量函数的极小点的利用来分类有两种：第一类是能量函数的所有极小点都起作用，这一类主要用作各种联想存储器；第二类只利用全局极小点，它主要用于求解最优化问题

#### 蠓虫分类问题与多层前馈网络

###### 蠓虫分类问题

> 蠓虫分类问题可概括叙述如下：生物学家试图对两种蠓虫（Af 与Apf）进行鉴别，依据的资料是触角和翅膀的长度，已经测得了9 支Af 和6 支Apf 的数据。
>
> 1. 根据如上资料，如何制定一种方法，正确地区分两类蠓虫。
> 2. 对触角和翼长分别为(1.24,1.80)，(1.28,1.84)与(1.40,2.04)的3 个标本，用所得到的方法加以识别。
> 3. 设Af 是宝贵的传粉益虫，Apf 是某疾病的载体，是否应该修改分类方法。

如上的问题是有代表性的，它的特点是要求依据已知资料（9 支Af 的数据和6 支Apf 的数据）制定一种分类方法，类别是已经给定的（Af 或Apf）。今后，我们将9 支Af 及6 支Apf 的数据集合称之为**学习样本**。

######多层前馈网络

###### 向后传播算法

 对于一个多层网络，如何求得一组恰当的权值，使网络具有特定的功能，在很长一段时间内，曾经是使研究工作者感到困难的一个问题，直到1985 年，美国加州大学的一个研究小组提出了所谓向后传播算法（Back-Propagation），使问题有了重大进展，这
一算法也是促成人工神经网络研究迅猛发展的一个原因。下面就来介绍这一算法。

如前所述，我们希望对应于学习样本中 Af 样品的输出是(1,0)，对应于 Apf 的输出是(0,1)，这样的输出称之为理想输出。实际上要精确地作到这一点是不可能的，只能希望实际输出尽可能地**接近**理想输出。为清楚起见，把对应于样品s 的理想输出记为 $\{T_i^s\}$，那么

$$
E(W)=\frac{1}{2}\sum_{i,s}(T_i^s-O_i^s)^2  \notag
$$

度量了在一组给定的权下，实际输出与理想输出的差异，由此，寻找一组恰当的权的问题，自然地归结为求适当 $W​$ 的值，使 $E(W)​$ 达到极小的问题。采用**最速下降法**。利用这一迭代算法，最终生成在一定精度内满足要求的 $\{w_{ij},\overline w_{jk}\}​$ 的过程，称为人工神经网络的学习过程。可以看出，这里所提供的学习机制是元与元之间权的不断调整，学习样本中任何一个样品所提供的信息，最终将包含在网络的每一个权之中。参数 $\eta​$ 的大小则反映了学习效率。

为了更有效地应用 BP 算法，我们做出如下一些补充说明:

* 实际上，我们还可以每次仅考虑输入一个样品所造成的修正，然后，按照随机选取的顺序，将所有样品逐个输入，不断重复这一手续，直至收敛到一个满意的解为止
* 在如上的算法中，利用实际输出与理想输出差的平方和作为度量 $\{w_{ij},\overline w_{jk}\}$ 优劣的标准，这并不是唯一的度量方式，完全可以从其它的函数形式出发，例如从相对熵出发，导出相应的算法。
* 在如上的讨论中使用的是最速下降法，显然，这也不是唯一的选择，其它的非线性优化方法，诸如共轭梯度法，拟牛顿法等，都可用于计算。为了加速算法的收敛速度，还可以考虑各种不同的修正方式。
* BP 算法的出现，虽然对人工神经网络的发展起了重大推动作用，但是这一算法仍有很多问题．对于一个大的网络系统，BP 算法的工作量仍然是十分可观的，这主要在于算法的收敛速度很慢。更为严重的是，此处所讨论的是非线性函数的优化，那么它就无法逃脱该类问题的共同困难：BP 算法所求得的解，只能保证是依赖于初值选取的局部极小点。为克服这一缺陷，可以考虑改进方法，例如**模拟退火**算法，或从多个随机选定的初值点出发，进行多次计算，但这些方法都不可避免地加大了工作量。

###### 蠓虫分类问题的求解

```matlab
clear
p1=[1.24,1.27;1.36,1.74;1.38,1.64;1.38,1.82;1.38,1.90;
1.40,1.70;1.48,1.82;1.54,1.82;1.56,2.08];
p2=[1.14,1.82;1.18,1.96;1.20,1.86;1.26,2.00
1.28,2.00;1.30,1.96];
p=[p1;p2]';
pr=minmax(p);
goal=[ones(1,9),zeros(1,6);zeros(1,9),ones(1,6)];
plot(p1(:,1),p1(:,2),'h',p2(:,1),p2(:,2),'o')
net=newff(pr,[3,2],{'logsig','logsig'});
net.trainParam.show = 10;
net.trainParam.lr = 0.05;
net.trainParam.goal = 1e-10;
net.trainParam.epochs = 50000;
net = train(net,p,goal);
x=[1.24 1.80;1.28 1.84;1.40 2.04]';
y0=sim(net,p)
y=sim(net,x)
```

#### 处理蠓虫分类的另一种网络方法
