## 数理统计

### 原理部分——建模

------

数理统计研究的对象是受随机因素影响的数据，以下**数理统计**就简称统计，统计是以概率论为基础的一门应用学科。数据样本少则几个，多则成千上万，人们希望能用少数几个包含其最多相关信息的数值来体现数据样本总体的规律。它是统计推断的基础，实用性较强，在统计工作中经常使用。面对一批数据如何进行描述与分析，需要掌握**参数估计和假设检验**这两个数理统计的最基本方法。

#### 总体和样本

样本作为随机变量而有一定的分布，这个概率即样本分布。一个问题的统计模型就是指研究该问题是抽取样本的分布，也常称为概率模型。

##### 统计量

1. 样本均值：$\overline{X}=\frac{1}{n}\sum \limits_{i=1}^nX_i$

2. 样本方差：$\sigma^2=\frac{1}{n-1}\sum \limits_{i=1}^n(\overline{X}-X_i)^2$

   > 均为无偏估计。$n-1$ 称为其自由度，可解释为作为 $n$ 个变元的函数自由度应该是 $n$ ，但由于已经估计了总体分布的均值，故而下降1

3. 样本协方差：$Cov(X,Y)=\frac{1}{n-1}\sum \limits_{i=1}^n(\overline{X}-X_i)(\overline{Y}-Y_i)$ 

4. 样本相关系数：
$$
\rho(X,Y)=\frac{Cov(X,Y)}{\sigma_X\cdot \sigma_Y}=\frac{\sum \limits_{i=1}^n(\overline{X}-X_i)(\overline{Y}-Y_i)}{\sqrt{\sum \limits_{i=1}^n(\overline{X}-X_i)^2\sum \limits_{i=1}^n(\overline{Y}-Y_i)^2}}
$$



5. 中心矩、表示分布形状的统计量—**偏度和峰度**

> 随机变量 $x$ 的 $r$ 阶中心矩为 $E(x − E(x))^r$ 。随机变量 $x$ 的偏度和峰度指的是 $x$ 的标准化变量 $(x − E(x))/ \sqrt{Dx} $ 的三阶中心矩和四阶中心矩。偏度反映分布的**对称性**， $v_1>0$ 为右偏态，此时数据位于均值右边的比位于左边的多。而 $v_1$ 接近0则可认为分布是对称的。峰度是分布形状的另一种度量，正态分布的峰度为 3，若 $v_2$ 比 3 大得多，表示分布有沉重的尾巴，说明样本中含有较多远离均值的数据，因而峰度可以用作衡量**偏离正态分布的尺度**之一

> Matlab 中 `moment(x,order)` 返回 $x$ 的 `order` 阶中心矩，order 为中心矩的阶数。`skewness(x)` 返回 $x$ 的偏度，`kurtosis(x)` 返回峰度

##### 无偏估计

设样本 $X$ 的总体分布依赖于参数 $\theta$ ，$g(\theta)$ 是已知函数（但是不能直接求出来），$\widehat{g}(X)$ 是 $g(\theta)$ 的一个估计值，估计是是无偏的，即
$$
E_{\theta}[\widehat{g}(X)]=g(\theta)
$$

> For example:
>
> 1. 取 $g(\theta)$ 为分布的期望 $\mu_X$，$\overline{X}$ 便是它的一个估计 $\widehat{g}(X)$

$$
E(\overline{X})=E(\frac{1}{n}\sum_{i=1}^nX_i)=\frac{1}{n}\sum_{i=1}^nE(X_i)=\frac{1}{n}\sum_{i=1}^n \mu_X=\mu_X
$$

> 从而均值是期望的无偏估计，方差同理可证

##### 抽样分布（sampling distrbution）

统计量的概率分布称为（该统计量的抽样分布），这个问题意义重大，因为事实上我们估计的统计量也是一个随机的，因而要对一种特定的统计推断方法全面的了解，必须知道其抽样分布（即想知道估计出来的值出现的可能性大小问题），如用样本均值 $\overline{X}$ 估计正态分布的均值 $a$ ，那么两者之差有多大？即概率 $P(|\overline{X}-a|>c)$ ，要计算这个概率就需要知道 $\overline{X}$ 的抽样分布

##### 重要分布

然而能算出抽样分布的情况为数不多。所幸的是，有一个重要情况，即总体分布分布为正态时，许多重要统计量的抽样分布已经得出。这也就是统计中三大分布重要的原因，他们都与正态分布有关系。

###### $\chi^2$ 分布 (Chi square)

若 $X_1,X_2,\cdots,X_n$ 为相互独立的、服从标准正态分布  $N(0,1)$ 的随机变量，则它们的平方和服从 $\chi^2$ 分布，记作
$$
Y\backsim \chi^2(n)
$$
$n$ 称自由度，它的期望 $EY = n$ ，方差  $DY = 2n$

> 自由度可解释为二次型 $\sum \limits_{i=1}^nX_i^2$ 的矩阵为单位阵，满秩

**正态分布抽样分布：**$X_1,X_2,\cdots,X_n \sim N(a,\sigma^2)$ 

1. $\overline{X} \sim N(a,\sigma^2/n)$
2. $(n-1)S^2/\sigma^2 \sim \chi_{n-1}^2$
3. 样本均值与方差独立

> 　可见此定理对正态分布参数的统计推断有重大意义



###### $t$ 分布

若 $X\backsim N(0,1)$，$Y\backsim \chi^2(n)$，且相互独立，则 $T=\frac{X}{\sqrt{Y/n}}$ 服从 $t$ 分布，记作 $T\backsim t(n)$ ，$n$ 称自由度。$t$ 分布又称学生氏(Student)分布。其分布的密度函数曲线和 $N(0,1)$ 曲线形状相似。理论上 $n \rightarrow \infty$ 时，$T\backsim t(n)\rightarrow N(0,1)$ 实际上当 $n > 30$ 时它与 $N(0,1)$ 就相差无几了



###### $F$ 分布

$X\backsim \chi^2(n_1),Y\backsim \chi^2(n_2)$ 且相互独立，则 $F=\frac{X/n_1}{Y/n_2}$ 服从 $F$ 分布，记作 
$$
F \backsim F(n_1,n_2)
$$


#### 参数估计

利用样本对总体进行统计推断的一类问题是参数估计，即**假定**已知总体的分布，通常是 $X \backsim N(\mu,\sigma^2 )$ ，估计有关的参数。参数估计分点估计和区间估计两种

##### 点估计

点估计是用样本统计量**确定**总体参数的一个数值。

评价估计优劣的标准有：

- 无偏性
- **最小方差性**
- 有效性

估计的的方法有：

- 矩法
- 极大似然法

最常用的便是对**总体均值和方差**作点估计

###### 矩估计

即用样本矩估计总体矩，显然样本均值与方差便是对总体矩中期望与方差的矩估计

###### 极大似然估计（MLE）

设样本 $X$ 有概率函数 $f(x,\boldsymbol{\theta})$ ，其中 $\boldsymbol{\theta}$ 为分布中未知的常数参数（如均值，方差等）

1. 固定 $\boldsymbol{\theta}$ ,则得到总体分布，可确定样本取值的概率
2. 然而一般是不知道总体分布的，即 $\boldsymbol{\theta}$ 有待确定，而知道样本 $x$ ，故可以最大化 $x$ 出现的概率在估计参数 $\boldsymbol{\theta}$ ，此即极大似然法。固定 $x$ 时的函数成为似然函数


$$
f(x,\widehat{\theta}(x))=\sup \limits_{\theta \in \Theta} f(x,\theta) \quad (x\in \mathscr{X})
$$
其中 $ \mathscr{X}$ 是样本空间，$\widehat{\theta}(x)$ 称为 $\boldsymbol{\theta}$ 的极大似然估计。通常为了计算方便用他的对数似然函数
$$
\ln f(x,\widehat{\theta}(x))=\sup \limits_{\theta \in \Theta}\ln f(x,\theta) \quad (x\in \mathscr{X})
$$

> 转化为**极值**问题

##### 区间估计

点估计虽然给出了待估参数的一个数值，却没有告诉我们这个估计值的**精度**和**可信程度**。一般地，总体的待估参数记作 $\theta$ ，由样本算出的估计量记作  $\widehat\theta$ ，人们常希望给出一个区间 $[\widehat\theta_1,\widehat\theta_2]$ ，使 $\theta$ 以一定的概率落在此区间内。若有
$$
P\{\widehat \theta_1<\theta<\widehat \theta_2\}=1-\alpha,0<\alpha<1  \notag
$$
则 $[\widehat\theta_1,\widehat\theta_2]$ 称为置信区间，$1-\alpha$ 称为置信概率或置信水平。$\alpha$ 为显著性水平，越小越好。置信区间越小，估计的精度越高；置信水平越大，估计的可信程度越高。但是这两个指标显然是矛盾的，通常是在**一定的置信水平下使置信区间尽量小**。通俗地说，区间估计给出了点估计的误差范围

###### 参数估计的 Matlab 实现

Matlab 统计工具箱中，有专门计算总体均值、标准差的点估计和区间估计的函数。对于正态总体，命令是 `[mu,sigma,muci,sigmaci]=normfit(x,alpha)` 其中 `x` 为样本（数组或矩阵），`alpha` 为显著性水平 $\alpha$ （ `alpha` 缺省时设定为0.05），返回总体均值 $\mu$ 和标准差 $\sigma$ 的点估计 `mu` 和 `sigma`，及总体均值 $\mu$ 和标准差 $\sigma$ 的区间估计 `muci` 和 `sigmaci` 。当 `x` 为矩阵时，`x` 的每一列作为一个样本。

Matlab 统计工具箱中还提供了一些具有特定分布总体的区间估计的命令，如`expfit，poissfit，gamfit`，你可以从这些字头猜出它们用于哪个分布，具体用法参见帮助系统

1. Matlab 统计工具箱(Toolbox\Stats)中的概率分布

   Matlab 统计工具箱中有27 种概率分布，这里只对上面所述4 种分布列出命令的字符：

   - `norm`      正态分布
   - `chi2`      $\chi^2$分布
   - `t`            t分布
   - `f`            F分布

   工具箱对每一种分布都提供 5 类函数，其命令的字符是：

   - `pdf` 概率密度
   - `cdf` 分布函数
   - `inv` 分布函数的反函数
   - `stat` 均值与方差
   - `rnd` 随机数生成

   正态分布图像绘制:

   ```matlab
   x=-6:0.01:6;y=normpdf(x);z=normpdf(x,0,2);
   plot(x,y,x,z),gtext('N(0,1)'),gtext('N(0,2^2)') %手动标点
   ```

###### 正态总体统计量的分布

只有在总体服从正态分布时，一些重要的样本统计量（均值、标准差）的分布才有便于使用的结果。另一方面，现实生活中需要进行统计推断的总体，多数可以认为服从（或近似服从）正态分布，所以统计中人们在正态总体的假定下研究统计量的分布，是必要的与**合理**的



#### 假设检验

统计推断的另一类重要问题是假设检验问题。在总体的分布函数完全未知或只知其形式但不知其参数的情况，为了推断总体的某些性质，提出某些关于总体的假设。假设检验就是根据样本对所提出的假设做出**判断**：是接受还是拒绝。这就是所谓的假设检验问题。

假设 $H$ ：$X_1,X_2,\cdots,X_n$ 是具有分布 $F$ 的总体中抽出来的样本

检验的方法是：指定阈值 $\alpha$ （一般取0.05），算出拟合优度 $p$ 。当 $p < \alpha$ 时否定 $H$ 



假设检验有三种

1. **双边检验：**$H_0:\mu=\mu_0,H_1:\mu \ne\mu_0$ （默认）

2. 右边检验：$H_0:\mu\le\mu_0,H_1:\mu >\mu_0$

3. 左边检验：$H_0:\mu\ge\mu_0,H_1:\mu<\mu_0$

   

##### 单个总体 $N(\mu,\sigma^2 )$ 均值 $\mu$ 的参数检验

###### $\sigma^2$ **已知，关于 $\mu$ 的检验（ $Z$ 检验）**

`[h,p,ci]=ztest(x,mu,sigma,alpha,tail)`

其中输入参数 `x `是样本，`mu` 是 $H_0$ 中的 $\mu_0$，`sigma` 是总体标准差 $\sigma$ ，`alpha` 是显著性水平 $\alpha$ （alpha 缺省时设定为0.05），`tail` 是对备选假设 $H_1$ 的选择:

   - `tail`=0(可缺省)——双边检验
   - `tail`=1——右边检验
   - `tail`=-1——左边检验

 输出数`h`=0表示接受 $H_0$ ，`h`=1 表示拒绝。`p` 表示在假设$H_0$ 下样本均值出现的概率，`p` 越小 $H_0$ 越值得怀疑，`c` 是$\mu_0$ 的置信区间

 案例

   > 某车间用一台包装机包装糖果。包得的袋装糖重是一个随机变量，它服从正态分布。当机器正常时，其均值为0.5 公斤，标准差为0.015 公斤。某日开工后为检验
   > 包装机是否正常，随机地抽取它所包装的糖9 袋，称得净重为（公斤）：0.497 0.506 0.518 0.524 0.498 0.511 0.520 0.515 0.512

   ```matlab
   x=[0.497 0.506 0.518 0.524 0.498...
   0.511 0.520 0.515 0.512];
   [h,p,ci]=ztest(x,0.5,0.015)
   ```

求得`h`=1，`p`=0.0248，说明在0.05 的水平下，可**拒绝**原假设，即认为这天包装机工作不正常



###### $\sigma^2$**未知，关于 $\mu$ 的检验（ $t$ 检验）**

`[h,p,ci]=ttest(x,mu,alpha,tail)`

```matlab
x=[159 280 101 212 224 379 179 264 ...
222 362 168 250 149 260 485 170];
[h,p,ci]=ttest(x,225,0.05,1)
```

求得`h`=0，`p`=0.2570，说明在显著水平为 0.05 的情况下，不能拒绝原假设，认为元件的平均寿命不大于225 小时。

> t检验不需要知道[总体方差](https://www.baidu.com/s?wd=%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)，它用样本方差替代[总体方差](https://www.baidu.com/s?wd=%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)，得到的统计量服从 $t$ 分布。实践应用中，t 检验比 z 检验常用，因为不容易知道总体的方差。t 检验来源于戈斯特的笔名student。 





##### **两个正态**总体均值差的参数检验（ t 检验）

还可以用 $t$ 检验法检验具有相同方差的2个正态总体均值差的假设。在Matlab 中由函数ttest2 实现，命令为：

`[h,p,ci]=ttest2(x,y,alpha,tail)`

> `h = ttest2(x,y,alpha,tail, 'unequal')` 方差不等



##### 参数检验和非参数检验

> 1. 参数检验是针对**参数**做的假设，非参数检验是针对**总体**分布情况做的假设，这个是区分参数检验和非参数检验的一个**重要特征**。
> 2. 二者的根本区别在于参数检验要利用到总体的信息（总体分布、总体的一些参数特征如方差），**以总体分布和样本信息对总体参数作出推断**；非参数检验不需要利用总体的信息（总体分布、总体的一些参数特征如方差），以**样本信息对总体分布作出推断**。
> 3. 能用参数检验优先使用参数检验



##### $Q-Q$ 图——分布检验，但需先估计参数

对于一组数据在用参数估计法确定了模型参数后，分布函数 $F(x,\theta) $ 便也就知道了，现在希望观测数据与分布模型拟合的效果如何。

> 介绍：经验分布函数
>
> 一般的，设 $x_1,x_2,\cdots,x_n$ 是总体 $ F$ 的一个样本，现将样本从小到大排序并重新编号记为 $x_{(1)},x_{(2)} \cdots$ 则分布函数的观察值为：
> $$
> {F_n}(x) = \left\{ \begin{array}{l}
> 0,\;\;\;\;\;if\;\;x < {x_{(1)}}\\
> \frac{k}{n},\;\;\;\;if\;\;{x_{(k)}} \le x \le {x_{(k + 1)}}\\
> 1,\;\;\;\;\;if\;\;x > {x_{(n)}}
> \end{array} \right.
> $$
> Glivenko 1933证明了当 $n \rightarrow \infty$ 时经验分布函数以概率1收敛之总体分布函数 $F_n(x)$ 

Q-Q 图的思想便是把经验分布函数的分位数和理论分布的分位数作为一对数画在直角坐标中，形成一条45°直线，因而判断数据是否来自特定分布的计算步骤如下：

1. 将原数据 $x_1,x_2,\cdots,x_n$ 依大小升序排列 $x_{(1)},x_{(2)} \cdots x_{(n)}$
2. 取 $y=F^{-1}(\frac{i-0.5}{n}),i=1,2,\cdots,n$
3. plot ($x_{(i)},y_i$) 
4. 如果这 $n$ 个点看起来呈一条45°角的直线，从 $(0,0)\rightarrow(1,1)$ 则数据拟合分布 $F(x) $ 的效果较好





##### 分布拟合检验——非参数检验法

在实际问题中，有时不能预知总体服从什么类型的**分布**，这时就需要根据样本来检验关于**分布**的假设

###### $\chi^2$**检验法**

步骤：

1. 建立待检验假设 $H_0$： 总体 $X$ 的分布函数为 $F(x)$ 
2. 在数轴上选取 $k-1$ 个分点 $t_1,t_2,\cdots,t_{k-1}$ 将数轴分为 $k$ 个区间，令 $p_i$ 为分布函数 $F(x)$ 在第 $i$ 个区间内取值的概率，而 $m_i$ 为样本观测值中落入第 $i$ 个区间的个数，也称为组频数
3. 选取统计量 $\chi^2=\sum \limits_{i=1}^k\frac{(m_i-np_i)^2}{np_i}$ ，如果$H_0$ 为真，则 $\chi^2 \sim\chi^2 (k-1-r)$ ，其中 $r$ 为分布函数未知参数的个数
4. 对于给定的显著性水平 $\alpha$ 确定 $\chi_{\alpha}^2$ 使得 $P\{\chi^2(k-1-r)>\chi_{\alpha}^2\}=\alpha$ 并依据样本计算出 $\chi^2$
5. 作出判断：若 $\chi^2<\chi_{\alpha}^2$ 。则接受假设 $H_0$ 。

> 从上述过程可以看出卡方检验实际上是在检验 
> $$
> p_i=F_0(a_i)-F(a_{i-1})=p_{i0},i=1,2,\cdots,k
> $$
>

案例

```matlab
clc
x=[141 148 132 138 154 142 150 146 155 158 ...
150 140 147 148 144 150 149 145 149 158 ...
143 141 144 144 126 140 144 142 141 140 ...
145 135 147 146 141 136 140 146 142 137 ...
148 154 137 139 143 140 131 143 141 149 ...
148 135 148 152 143 144 141 143 147 146 ...
150 132 142 142 143 153 149 146 149 138 ...
142 149 142 137 134 144 146 147 140 142 ...
140 137 152 145];
mm=minmax(x) %求数据中的最小数和最大数
hist(x,8) %画直方图
fi=[length(find(x<135)),...
length(find(x>=135&x<138)),...
length(find(x>=138&x<142)),...
length(find(x>=142&x<146)),...
length(find(x>=146&x<150)),...
length(find(x>=150&x<154)),...
length(find(x>=154))] %各区间上出现的频数
mu=mean(x),sigma=std(x) %均值和标准差
fendian=[135,138,142,146,150,154] %区间的分点
p0=normcdf(fendian,mu,sigma) %分点处分布函数的值
p1=diff(p0) %中间各区间的概率
p=[p0(1),p1,1-p0(6)] %所有区间的概率
chi=(fi-84*p).^2./(84*p)
chisum=sum(chi) %皮尔逊统计量的值
x_a=chi2inv(0.9,4) %chi2分布的0.9分位数
```

求得皮尔逊统计量 `chisum`= 2.2654, $\chi_{0,1}^2=7.7794$ 故在水平0.1下接受 $H_0$ ，即认为数据来自正态分布总体。

###### 柯西莫哥洛夫检验 ——KS 检验

> 必须是连续性分布

经验分布以概率收敛道真实分布，定义 $F_n(x),F(x)$ 的距离为
$$
D_n=\sup \limits_{-\infty<x<+\infty}|F_n(x)-F(x)|
$$
检验统计量建立在 $D_n$ 基础上。

如果检验统计量 $\sqrt{n}D_n$ 落在了拒绝域 $[t_\alpha,+\infty]$ 中，则拒绝原假设



##### 秩和检验(检验总体是否有相同的分布)

Wilcoxon秩和检验

`[p,h]=ranksum(x,y,alpha)`

>  分布函数、密度函数和分位数
>
> 随机变量的特性**完全**由它的（概率）分布函数或（概率）密度函数来描述。设有随机变量 $X$，其分布函数定义为 $X \le x$ 的概率，即 $F(x) = P\{X \le x\}$ 。若 $X$ 是连续型随机变量，则其密度函数  $p(x)$ 与 $F(x)$ 的关系为

$$
F(x)=\int_{-\infty}^xp(x)dx  \notag
$$
> 上 $\alpha$ 分位数是下面常用的一个概念，其定义为：对于 $0 <\alpha <1$ ，使某分布函数 $F(x) =1−\alpha$ 的 $x$，称为这个分布的上 $\alpha$ 分位数，记作 $\alpha_x$ 。直方图可以看作密度函数图形的（离散化）**近似**







### 编程部分

重点：

1. 参考小黄书实现以上参数估计与检验

2. 绘制出美观的频率直方图、核密度估计、分布拟合（正态等）密度曲线一体图

3. 结果可视化图表

   ![norm_t_dict](C:\Users\16053\Desktop\norm_t_dict.png)

### 论文部分

找找表达方式和可视化方法，这里大部分检验算法并不需要算法流程图